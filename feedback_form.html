<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ú¯Ø§Ù‡ Ø´Ù…Ø§ Ù…Ù‡Ù… Ø§Ø³Øª</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background: #1a2a44;
            color: #ffffff;
            direction: rtl;
            text-align: right;
            padding: 20px;
            margin: 0;
        }
        .container {
            max-width: 700px;
            margin: 50px auto;
            background: #23395d;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.6);
        }
        h2 {
            color: #00C4B4;
            text-align: center;
            margin-bottom: 25px;
            font-size: 28px;
        }
        .brand {
            text-align: center;
            font-size: 32px;
            color: #00C4B4;
            margin-bottom: 20px;
            font-weight: bold;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #00C4B4;
        }
        input, select, textarea {
            width: 100%;
            padding: 14px;
            margin-bottom: 20px;
            border: none;
            border-radius: 10px;
            background: #ffffff;
            color: #000000;
            font-size: 16px;
            text-align: right;
            box-shadow: inset 0 3px 6px rgba(0, 0, 0, 0.1);
        }
        textarea {
            resize: vertical;
            min-height: 100px;
        }
        button {
            width: 100%;
            padding: 14px;
            background: #00C4B4;
            color: #ffffff;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            transition: background 0.3s ease, transform 0.2s ease;
        }
        button:hover {
            background: #00a69a;
            transform: scale(1.02);
        }
        .footer {
            text-align: center;
            margin-top: 25px;
            font-size: 14px;
            color: #d3d3d3;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="brand">CQBOOSTER</div>
        <h2>Ù†Ú¯Ø§Ù‡ Ø´Ù…Ø§ Ù…Ù‡Ù… Ø§Ø³Øª</h2>
        <form id="globalForm">
            <label>Ù…ÙˆØ¶ÙˆØ¹ Ù†Ø¸Ø±:</label>
            <select id="topic" required>
                <option value="Ø¨Ø§Ø²Ø®ÙˆØ±Ø¯">Ø¨Ø§Ø²Ø®ÙˆØ±Ø¯</option>
                <option value="Ø§Ù†ØªÙ‚Ø§Ø¯">Ø§Ù†ØªÙ‚Ø§Ø¯</option>
                <option value="Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯">Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯</option>
            </select>
            <label>Ú†Ø·ÙˆØ± Ø¨Ø§ Ù…Ø§ Ø¢Ø´Ù†Ø§ Ø´Ø¯ÛŒØŸ</label>
            <input type="text" id="source" placeholder="Ù…Ø«Ù„Ø§Ù‹ Ø§Ø² Ø·Ø±ÛŒÙ‚ Ø¯ÙˆØ³Øª ÛŒØ§ ÙˆØ¨â€ŒØ³Ø§ÛŒØª">
            <label>Ø§Ø³Ù… ÛŒØ§ Ù†Ø§Ù… Ù…Ø³ØªØ¹Ø§Ø±:</label>
            <input type="text" id="name" placeholder="Ø§Ø³Ù… Ø®ÙˆØ¯Øª Ø±Ùˆ Ø¨Ù†ÙˆÛŒØ³" required>
            <label>ØªÙ„ÙÙ† ÛŒØ§ Ø§ÛŒÙ…ÛŒÙ„ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):</label>
            <input type="text" id="contact" placeholder="ØªÙ„ÙÙ† ÛŒØ§ Ø§ÛŒÙ…ÛŒÙ„Øª Ø±Ùˆ ÙˆØ§Ø±Ø¯ Ú©Ù†">
            <label>Ø±Ø¶Ø§ÛŒØªØª Ú†Ø·ÙˆØ±Ù‡ØŸ</label>
            <select id="score" required>
                <option value="Ø®ÛŒÙ„ÛŒ Ø¨Ø¯ ğŸ˜">Ø®ÛŒÙ„ÛŒ Ø¨Ø¯ ğŸ˜</option>
                <option value="Ø¨Ø¯ ğŸ˜•">Ø¨Ø¯ ğŸ˜•</option>
                <option value="Ù…Ø¹Ù…ÙˆÙ„ÛŒ ğŸ˜" selected>Ù…Ø¹Ù…ÙˆÙ„ÛŒ ğŸ˜</option>
                <option value="Ø®ÙˆØ¨ ğŸ˜Š">Ø®ÙˆØ¨ ğŸ˜Š</option>
                <option value="Ø¹Ø§Ù„ÛŒ ğŸ¤©">Ø¹Ø§Ù„ÛŒ ğŸ¤©</option>
            </select>
            <label>Ù†Ø¸Ø±Øª Ú†ÛŒÙ‡ØŸ</label>
            <textarea id="message" placeholder="Ù‡Ø± Ú†ÛŒ ØªÙˆ Ø°Ù‡Ù†ØªÙ‡ Ø¨Ù†ÙˆÛŒØ³" required></textarea>
            <label>Ù…Ø§ÛŒÙ„ Ø¨Ù‡ Ø¯Ø±ÛŒØ§ÙØª Ø§Ø®Ø¨Ø§Ø± Ù‡Ø³ØªÛŒØŸ</label>
            <select id="updates" required>
                <option value="Ø¨Ù„Ù‡">Ø¨Ù„Ù‡</option>
                <option value="Ø®ÛŒØ±">Ø®ÛŒØ±</option>
            </select>
            <button type="submit">Ø§Ø±Ø³Ø§Ù„ Ù†Ø¸Ø± ğŸŒŸ</button>
        </form>
        <div class="footer">ØªÙ…Ø§Ù…ÛŒ Ø­Ù‚ÙˆÙ‚ Ø¨Ø±Ø§ÛŒ CommuniClinic Ù…Ø­ÙÙˆØ¸ Ø§Ø³Øª</div>
    </div>
    <script>
        document.getElementById("globalForm").addEventListener("submit", async (e) => {
            e.preventDefault();
            const name = document.getElementById("name").value;
            const contact = document.getElementById("contact").value;
            const topic = document.getElementById("topic").value;
            const message = document.getElementById("message").value;
            const score = document.getElementById("score").value;
            const source = document.getElementById("source").value;
            const updates = document.getElementById("updates").value;

            let userId = "unknown";
            let userName = "Ø¨Ø¯ÙˆÙ† Ù†Ø§Ù…";
            try {
                if (window.Telegram && window.Telegram.WebApp) {
                    window.Telegram.WebApp.ready();
                    const initData = window.Telegram.WebApp.initDataUnsafe;
                    if (initData && initData.user) {
                        const user = initData.user;
                        userId = user.id ? user.id.toString() : "unknown";
                        userName = user.username || user.first_name || "Ø¨Ø¯ÙˆÙ† Ù†Ø§Ù…";
                    } else {
                        throw new Error("Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù†ÛŒØ³Øª. Ù„Ø·ÙØ§Ù‹ Ø§Ø² ØªÙ„Ú¯Ø±Ø§Ù… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.");
                    }
                } else {
                    throw new Error("Ù„Ø·ÙØ§Ù‹ Ø§ÛŒÙ† ÙØ±Ù… Ø±Ø§ Ø§Ø² Ø¯Ø§Ø®Ù„ ØªÙ„Ú¯Ø±Ø§Ù… Ø¨Ø§Ø² Ú©Ù†ÛŒØ¯.");
                }
            } catch (error) {
                alert("Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±: " + error.message);
                return;
            }

            const response = await fetch("https://script.google.com/macros/s/AKfycbxQkg6iORMtnIj0xExHddl-LdNgAjR2kGYTA5tYdsAC_21D6lKHZuDC1ZE5tqzES6Uj/exec", {
                method: "POST",
                body: JSON.stringify({
                    name,
                    user_id: userId,
                    username: userName,
                    contact,
                    topic,
                    message,
                    score,
                    source,
                    updates,
                    timestamp: new Date().toISOString()
                })
            });

            if (response.ok) {
                alert("Ù†Ø¸Ø±ØªÙˆÙ† Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯. Ø§Ø² Ø§ÛŒÙ†Ú©Ù‡ Ø¨Ø§ Ù…Ø§ Ù‡Ù…Ø±Ø§Ù‡ Ù‡Ø³ØªÛŒØ¯ØŒ Ø³Ù¾Ø§Ø³Ú¯Ø²Ø§Ø±ÛŒÙ…!");
                document.getElementById("globalForm").reset();
                if (window.Telegram && window.Telegram.WebApp) {
                    window.Telegram.WebApp.close();
                }
            } else {
                const errorText = await response.text();
                alert("Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„: " + errorText);
            }
        });
    </script>
</body>
</html>
